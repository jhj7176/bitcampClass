<?xml version="1.0" encoding="UTF-8"?>


<project name="web08" default="startTomcat" basedir=".">

	<description>emp list</description>

	<!-- 필요한 경로를 프로퍼티로 저장 -->

	<property name="tomcat.home" value="C:/tomcat/apache-tomcat-7.0.104-windows-x64/apache-tomcat-7.0.104" />
	<property name="tomcat.wapps" value="${tomcat.home}/webapps" />
	<property name="classDir" value="C:/Workspace/web08/build" />
	<property name="app.name" value="web08" />
	<property name="app.path" value="/${app.name}" />
	<property name="build.home" value="${basedir}/build" />
	<property name="src.home" value="${basedir}/src" />
	<property name="web.home" value="${basedir}/WebContent" />
	<property name="jar.dir" value="${build.home}/jar" />


	<path id="project.classpath">
		<fileset dir="${tomcat.home}/lib">
			<include name="*.jar" />
		</fileset>
		<fileset dir="${web.home}/WEB-INF/lib">
			<include name="*.jar">
			</include>
		</fileset>
		<fileset dir="${ant.home}/lib" />
	</path>

	<target name="delete">
		<delete dir="${build.home}" />
		<delete>
			<fileset dir="${tomcat.wapps}">
				<include name="${ant.project.name}.*" />
			</fileset>
		</delete>
	</target>
	
	<!--
	Whether to include the Ant run-time libraries in the classpath. 
	앤트 런타임 라이브러리들을 클래스패스에 포함시킬지말지 여부를 결정. true of false.
	이 빌드파일의 동작이 환경에 민감하여 잘 안될 수도 있어서 false로 하는게 일반적이다.
	It is usually best to set this to false 
	so the script's behavior is 
	not sensitive to the environment 
	in which it is run.
	일반적, false샛팅하는게. 위해서. 스크립트동작이 환경에 안민감하다. 동작할때.
	-->

	<target name="compile" depends="create">
		<javac srcdir="${src.home}" 
			includeantruntime="false" 
			destdir="${build.home}/WEB-INF/classes" 
			classpathref="project.classpath" />
	</target>

	<target name="create" depends="delete">
		<mkdir dir="${build.home}" />
		<mkdir dir="${build.home}/WEB-INF" />
		<mkdir dir="${build.home}/WEB-INF/classes" />

		<copy todir="${build.home}" overwrite="true">
			<fileset dir="${web.home}">
				<include name="**/*.jsp" />
				<include name="**/*.png" />
				<include name="**/*.jpg" />
				<include name="**/*.jar" />
				<include name="**/*.jspf" />
			</fileset>
		</copy>

	</target>

	<target name="War" depends="compile">
		<war destfile="${ant.project.name}.war" webxml="${web.home}/WEB-INF/web.xml">
			<lib dir="${web.home}/WEB-INF/lib" />
			<classes dir="${build.home}/WEB-INF/classes" />
			<fileset dir="${build.home}" />
		</war>
	</target>


	<target name="Deploy" depends="War">	
		<copy file="${basedir}/web08.war" todir="${tomcat.wapps}">
		</copy>
	</target>

	<target name="startTomcat" depends="Deploy">
		<exec executable="${tomcat.home}/bin/startup.bat" />
		<antcall target="shutdownTomcat"></antcall>
	</target>
	
	<target name="shutdownTomcat">
		<exec executable="${tomcat.home}/bin/shutdown.bat" />
	</target>

</project>


















